(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"+X4V":function(t,e,n){"use strict";n.d(e,"a",(function(){return C}));var i=n("mrSG"),a=n("4R65"),r=n("OT7S"),o=n("ZWlK"),s=n("VphZ"),c=n("TYT/"),l=n("ea4N"),u=["spiderView"],p=["mapTree"],d=function(){function t(t){this.dialog=t,this.colors={OLT:"orange",Splitter:"#e75480"}}return t.prototype.ngAfterViewInit=function(){var t=this.mapTree.nativeElement,e=s.f(this.spiderView.nativeElement);this.spiderViewCreation(t,e,this.data,this)},t.prototype.spiderViewCreation=function(t,e,n,i){var a=this,r=t.offsetWidth,o=t.offsetHeight,c=r>0?r:500,l=o>0?o:500,u=c/2,p=l/2,d=Math.min(c,500)-20-20,h=e.append("g").attr("class","wrapper").attr("transform","translate("+u+","+p+")");this.arc=this.createArc(d),this.pie=this.rotatePieChart();var f=function(t){return"M"+t.source.x+","+t.source.y+"L"+t.target.x+","+t.target.y};this.donutArcsGroup=this.createDonutGroup(h,n),console.log(this.donutArcsGroup),this.createDonutArc(),this.linePointsGroup=this.createLineGroup(h,n),this.appendLineGroupPath(t,f,this.colors),this.appendLineToCircle(t),this.circleGroup=this.createCircleGroup(h,this.pie,n,t),this.createCircle(),this.appendLabelsInsideCircle(),this.appendLabelOutside(),this.bandsArcsGroup=h.selectAll(".bandsArcsGroup").data(this.colocatedCircleData).enter().append("g").attr("transform","translate(0,100)").style("cursor","pointer").attr("class","bandsArcsGroup");var g={x:100,y:0},y=s.d().startAngle(0).endAngle(-90*Math.PI/90+2*Math.PI).value((function(t){return t.value})).padAngle(.01).sort(null),v=h.selectAll(".circleGroup").data(y(n)).enter().append("g").style("cursor","pointer").attr("class","circleGroup").style("pointer-events",(function(t,e){return t.data.disabled?"none":"all"})).attr("transform",(function(e,n){var i=t.find("#donutArc"+n)[0],a=s.f(i).node(),r=a.getPointAtLength(a.getTotalLength()/2);return"translate("+r.x+","+r.y+")"}));v.append("circle").attr("class","circlePoints").attr("r",20).attr("stroke-width",1).attr("stroke","#FFFFFF").attr("fill",(function(t){return t.data.disabled?"#b3b3b3":t.data.color})).attr("cx",(function(t){return 0})).attr("cy",(function(t){return 0})),v.append("text").style("text-anchor","start").style("fill","#ffffff").style("font-size","12px").attr("class","donutText").attr("x",(function(t){return 50})).style("fill",(function(t){return t.data.disabled?"#b3b3b3":"#FFFFFF"})).attr("y",(function(t){var e=t.endAngle*(180/Math.PI);return e<=90?-10:e>=180?20:5})).text((function(t){return t.data.name}));var m=h.selectAll(".linePointsGroup").data(y(n)).enter().append("g").attr("class","linePointsGroup");m.append("path").attr("class",(function(e,n){var i=t.find("#donutArc"+n)[0],a=s.f(i).node(),r=a.getPointAtLength(a.getTotalLength()/2);return e.source={x:0,y:0},e.target={x:r.x,y:r.y},"linePoints"})).attr("stroke-width",1).attr("stroke","#FFFFFF").attr("fill","none").attr("d",f),m.append("circle").attr("class",(function(e,n){var i=t.find("#donutArc"+n)[0],a=s.f(i).node(),r=a.getPointAtLength(a.getTotalLength()/2);return e.source={x:0,y:180},e.target={x:r.x,y:r.y},"circlePointsEnd"})).attr("r",3).attr("fill","#FFFFFF").attr("cx",(function(t){return t.target.x})).attr("cy",(function(t){return t.target.y})),this.bandsArcsGroup.append("circle").attr("r",30).attr("stroke-width",(function(t){return t.fontValue?"":1})).attr("stroke",(function(t){return t.fontValue?"#ffffff":"#000000"})).attr("fill",(function(t){return t.color?t.color:"red"})).style("cursor","pointer"),this.bandsArcsGroup.append("svg:image").attr("width",24).attr("height",25.5).attr("xlink:href",(function(t){if(!t.fontValue)return"assets/images/Layers/planned-small-cell/plannedwhite.svg"})).attr("stroke-width",1).attr("stroke","#FFFFFF").attr("fill",(function(t){return console.log("pointSource, pointSource",g),"#b3b3b3"})).attr("x",(function(t){return-(g.x-90)})).attr("y",(function(t){return-(g.y+10)})),this.bandsArcsGroup.append("text").style("text-anchor","middle").style("dominant-baseline","middle").style("fill","#ffffff").style("color","#000").style("font-size","33px").style("font-family",(function(t){return t.fontFamily})).attr("y",(function(t){return 3})).attr("class","iconText").text((function(t){return t.fontValue})),this.bandsArcsGroup.append("text").attr("x",(function(t,e){return t.fontValue?g.y-27:g.y-38})).style("fill",(function(){})).style("font-size","12px").style("font-weight","bold").attr("y",(function(t,e){return g.x-55})).text((function(t){return t.tileName})),this.bandsArcsGroup.append("text").attr("x",(function(t,e){return t.fontValue?g.y-50:g.y-38})).style("font-family",'"Lato Medium", sans-serif').style("font-size","11px").attr("y",(function(t,e){return g.x-14})).text((function(t){return"Latitude & Longitude"})).style("fill","grey"),this.bandsArcsGroup.append("text").style("font-family",'"Lato Medium", sans-serif').attr("x",(function(t,e){return t.fontValue?g.y-50:g.y-38})).style("fill",(function(){})).style("font-size","10px").style("font-weight","bold").attr("y",(function(t,e){return g.x+5})).text((function(t){return t.latLng.lat+" "+t.latLng.lng})),this.bandsArcsGroup.append("text").style("text-anchor","start").style("dominant-baseline","middle").style("font-family",'"Lato Medium", sans-serif').style("fill",(function(){return"black"})).style("font-size","11px").attr("class","donutText").attr("x",(function(t,e){return 0==e?g.y-70:g.y+70})).attr("y",(function(t,e){return 0==e?l/10:-g.x/12})).style("font-weight",(function(t){return"bold"})).text((function(t){if(t.sapId)return t.sapId})),this.circleGroup.on("mouseover",(function(){s.f(this).select("circle").transition().attr("stroke",(function(t){return"#ffffff"})).attr("stroke-width",2)})).on("mouseout",(function(){s.f(this).select("circle").transition().attr("stroke","#FFFFFF").attr("stroke-width",1)})).on("click",(function(t){a.mainRef.openAdjSpider(t,a.mainLayerReference)})),e.on("click",(function(){$(t).parent().remove(),s.b.stopPropagation()}))},t.prototype.createArc=function(t){return s.a().innerRadius(.75*t/2).outerRadius(.75*t/2+30)},t.prototype.rotatePieChart=function(){return s.d().startAngle(-.5*Math.PI).endAngle(.5*Math.PI).value((function(t){return t.value})).sort(null)},t.prototype.createLines=function(){return s.c().x((function(t){return t.lx})).y((function(t){return t.ly}))},t.prototype.createDonutGroup=function(t,e){return t.selectAll(".donutArcsGroup").data(this.pie(e)).enter().append("g").attr("class","donutArcsGroup")},t.prototype.createDonutArc=function(){this.donutArcsGroup.append("path").attr("d",this.arc).style("fill","none").attr("class",(function(t,e){var n=/(^.+?)L/.exec(s.f(this).attr("d"))[1];return n=n.replace(/,/g," "),t.endAngle>180*Math.PI/180&&(n="M"+/0 0 1 (.*?)$/.exec(n)[1]+"L"+/M(.*?)A/.exec(n)[1]),s.f(this.parentNode).append("path").attr("class","hiddenDonutArcs").attr("id","donutArc"+e).attr("d",n).style("fill","none"),"donutArcs"}))},t.prototype.createLineGroup=function(t,e){return t.selectAll(".linePointsGroup").data(this.pie(e)).enter().append("g").attr("class","linePointsGroup")},t.prototype.appendLineGroupPath=function(t,e,n){return this.linePointsGroup.append("path").attr("class",(function(e,n){var i=$(t).find("#donutArc"+n)[0],a=s.f(i).node(),r=a.getPointAtLength(a.getTotalLength()/2);return e.source={x:0,y:100},e.target={x:r.x,y:r.y+40},"linePoints"})).attr("stroke-width",3).attr("stroke",(function(t,e){var i=t.data.type;return i?n[i]:"#7070708A"})).style("stroke-dasharray","5, 3").attr("fill","none").attr("d",e)},t.prototype.appendLineToCircle=function(t){return this.linePointsGroup.append("circle").attr("class",(function(e,n){var i=$(t).find("#donutArc"+n)[0],a=s.f(i).node(),r=a.getPointAtLength(a.getTotalLength()/2);return e.source={x:0,y:0},e.target={x:r.x,y:r.y},"circlePointsEnd"})).attr("r",3).attr("fill","#FFFFFF").attr("cx",(function(t){return t.target.x})).attr("cy",(function(t){return t.target.y}))},t.prototype.createCircleGroup=function(t,e,n,i){return t.selectAll(".circleGroup").data(e(n)).enter().append("g").style("cursor","pointer").style("pointer-events",(function(t,e){return t.data.disabled?"none":"all"})).attr("class","circleGroup").attr("transform",(function(t,e){var n=$(i).find("#donutArc"+e)[0],a=s.f(n).node(),r=a.getPointAtLength(a.getTotalLength()/2);return"translate("+r.x+","+r.y+")"}))},t.prototype.createCircle=function(){return this.circleGroup.append("circle").attr("class","circlePoints").attr("r",20).attr("stroke-width",1).attr("stroke","#FFFFFF").attr("fill",(function(t){return t.data.disabled?"#b3b3b3":t.data.color})).attr("cx",(function(t){return 0})).attr("cy",(function(t){return 0}))},t.prototype.createBandGroup=function(t,e){return this.bandGroup.append("line").attr("class","lineBands").attr("stroke-width",1).attr("stroke","#FFFFFF").attr("fill","none").attr("x1",t.x).attr("y1",t.y).attr("x2",e.x).attr("y2",e.y)},t.prototype.createBandLine=function(t,e){return this.bandGroup.append("line").attr("class","lineBands").attr("stroke-width",1).attr("stroke","#FFFFFF").attr("fill","none").attr("x1",t.x).attr("y1",t.y).attr("x2",e.x).attr("y2",e.y)},t.prototype.createBandCircle=function(t){return this.bandGroup.append("circle").attr("class","lineBandsCircle").attr("r",3).attr("fill","#FFFFFF").attr("cx",t.x).attr("cy",t.y)},t.prototype.appendLabelsInsideCircle=function(){return this.circleGroup.append("text").style("text-anchor","middle").style("dominant-baseline","middle").style("font-weight","bold").style("font-family",'"Lato Medium", sans-serif').style("fill","#000000").style("font-size","12px").attr("class","donutText").attr("x",(function(t){return 10})).attr("y",(function(t){return 30})).style("font-weight",(function(t){if(t.data.font)return"bold"})).text((function(t){return t.data.name}))},t.prototype.appendLabelOutside=function(){return this.circleGroup.append("text").style("text-anchor","middle").style("dominant-baseline","middle").style("fill","#ffffff").style("color","#ffffff").style("font-size","24px").style("font-family",(function(t){return t.data.font})).attr("x",(function(t){return 0})).attr("y",(function(t){return 0})).attr("class","iconText").text((function(t){return t.data.fontvalue}))},t.\u0275fac=function(e){return new(e||t)(c.Ub(l.b))},t.\u0275cmp=c.Ob({type:t,selectors:[["app-fiveg-adjacent-spider-view"]],viewQuery:function(t,e){var n;1&t&&(c.cd(u,!0),c.cd(p,!0)),2&t&&(c.Hc(n=c.nc())&&(e.spiderView=n.first),c.Hc(n=c.nc())&&(e.mapTree=n.first))},decls:5,vars:0,consts:[[1,"spidermain-wrapper"],[1,"spideroverlay"],["mapTree",""],[1,"spiderview","spider-fiveg-adjacent"],["spiderView",""]],template:function(t,e){1&t&&(c.ac(0,"div",0),c.ac(1,"div",1,2),c.pc(),c.Vb(3,"svg",3,4),c.Zb(),c.Zb())},styles:[".spidermain-wrapper[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;z-index:10000;top:0;overflow:auto}.spideroverlay[_ngcontent-%COMP%], .spideroverlay[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;overflow:auto}.spideroverlay[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   g[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]{display:inline-block}.spider-fiveg-adjacent[_ngcontent-%COMP%]{box-shadow:0 0 1rem 0 rgba(0,0,0,.2);border-radius:5px;position:relative!important;z-index:1;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);padding:0;background-color:hsla(0,0%,100%,.4)}"]}),t}(),h=n("D4RW"),f=n("dltC"),g=n("Kpmo"),y=n("RaP5"),v=n("i+93"),m=n("cUzu"),C=function(){function t(t,e,n,i){var r=this;this.dataShare=t,this.shapeService=e,this.http=n,this.dialog=i,this.allPoints=[],this.allPoints1=[],this.linkColor="red",this.structureDataLogical=[{name:"Structure",value:5,color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf207",eventname:"sites-tree-candidates-nominals",sapid:"I-MU-MUMB_ENB_I164"},{name:"Logical Connectivity",value:5,color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf207",eventname:"sites-tree-candidates-nominals",sapid:"I-MU-MUMB_ENB_I174"}],this.structureData=[{name:"OLT",value:5,color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf207",eventname:"sites-tree-candidates-nominals",sapid:"I-MU-MUMB_ENB_I164",type:"OLT"},{name:"Splitter 1",value:5,color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf207",eventname:"sites-tree-candidates-nominals",sapid:"I-MU-MUMB_ENB_I174",type:"Splitter"},{name:"Splitter 2",value:5,color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf207",eventname:"sites-tree-candidates-nominals",sapid:"I-MU-MUMB_ENB_I164",type:"Splitter"},{name:"Splitter 3",value:5,color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf207",eventname:"sites-tree-candidates-nominals",sapid:"I-MU-MUMB_ENB_I174",type:"Splitter"}],this.structureColocatedData=[{name:"Properties",value:5,color:"#8CC63F",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",frequency:.01492,eventname:"sites-tree-properties",radiuscircle:200,deviceType:[{device:"css router",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"L2 Switch",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"AG1 Router",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"OLT",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"Splitter 2",color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"OTB",color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"L2 Switch",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"AG1 Router",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5}]},{name:"Create Workorder",value:5,color:"#8dc63f",font:"Material-Design-Iconic-Font",fontvalue:"\uf222",disabled:!0,frequency:.02782,radiuscircle:100,eventname:"sites-tree-createworkorder",deviceType:[{device:"L2 Switch",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf222",value:5},{device:"AG1 Router",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf222",value:5},{device:"Splitter 2",color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf222",value:5},{device:"OTB",color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf222",value:5}]}],this.createLayer=function(t,e,n,i,r){this.zoomLevel=e,this.scaleMatrix=this.zoomLevel<=7?.4:this.zoomLevel<=10?.5:this.zoomLevel<=13?.75:this.zoomLevel<=15?.5:.75,this.scaleMatrix=this.scaleMatrix*this.pixelRatio,null!=this.stageLogicalConnectivity&&(this.stageLogicalConnectivity.removeAllChildren(),this.stageLogicalConnectivity.update()),this.stageLogicalConnectivity=new o.Stage(t),this.stageLogicalConnectivity.enableDOMEvents(!0),this.stageLogicalConnectivity.enableMouseOver(5e4),this.logicalConnectivityContainer=new o.Container,this.logicalConnectivityLineContainer=new o.Container,this.logicalConnectivityCircleContainer=new o.Container;for(var s=0;s<n.length;s++){for(var c=0;c<n[s][4].boundary.length;c++)for(var l in this.allPoints["'"+n[s][1].rj_r4g_state_name+"'"]=[],this.allPoints1["'"+n[s][1].rj_r4g_state_name+"'"]=[],n[s][4].boundary[c])for(var u=0;u<n[s][4].boundary[c][l].length;u++)if(this.allPoints["'"+n[s][1].rj_r4g_state_name+"'"].push([n[s][4].boundary[c][l][u].latlng[0],n[s][4].boundary[c][l][u].latlng[1]]),this.allPoints1["'"+n[s][1].rj_r4g_state_name+"'"].push([n[s][4].boundary[c][l][u].latlng[0],n[s][4].boundary[c][l][u].latlng[1],n[s][4].boundary[c][l][u].type,n[s][4].boundary[c][l][u].sapid,n[s][4].boundary[c][l][u].sector,n[s][4].boundary[c][l][u].band,n[s][4].boundary[c][l][u].cnum]),null!=n[s][4].boundary[c][l][u].connectivity)for(var p=0;p<n[s][4].boundary[c][l][u].connectivity.length;p++)this.allPoints1["'"+n[s][1].rj_r4g_state_name+"'"].push([n[s][4].boundary[c][l][u].latlng[0],n[s][4].boundary[c][l][u].latlng[1],n[s][4].boundary[c][l][u].type,n[s][4].boundary[c][l][u].sapid,n[s][4].boundary[c][l][u].sector,n[s][4].boundary[c][l][u].band,n[s][4].boundary[c][l][u].cnum,n[s][4].boundary[c][l][u].connectivity[p].latlng[0],n[s][4].boundary[c][l][u].connectivity[p].latlng[1],n[s][4].boundary[c][l][u].connectivity[p].type,n[s][4].boundary[c][l][u].connectivity[p].sapid,n[s][4].boundary[c][l][u].connectivity[p].sector,n[s][4].boundary[c][l][u].connectivity[p].band,n[s][4].boundary[c][l][u].connectivity[p].cnum]);var d={},h={};this.allPoints["'"+n[s][1].rj_r4g_state_name+"'"].forEach((function(t){d[t]=(d[t]||0)+1,d[t]>1&&(h[t]=d[t])}));var f={},g={};this.allPoints1["'"+n[s][1].rj_r4g_state_name+"'"].forEach((function(t){f[t]=(f[t]||0)+1,g[t]=f[t]}))}var y=Object.entries(h),v=Object.entries(g),m=[],C=[];if(0==y.length)for(var L=0;L<v.length;L++)C.push(v[L]);else for(var x=0;x<y.length;x++){var b=y[x][0].split(",").map(String);for(L=0;L<v.length;L++){var F=v[L][0].split(",").map(String);F.length>7?C.push(v[L]):F[0]==b[0]&&F[1]==b[1]?m.push(v[L]):C.push(v[L])}}for(var w=0;w<C.length;w++)1==C[w][1]&&this.drawStructureImage(this.positionLatLng,this.linksCenterPoint,this.logicalConnectivityContainer,C[w],this.imagePath);for(this.logicalConnectivityContainer.addChild(this.logicalConnectivityLineContainer,this.logicalConnectivityCircleContainer),x=0;x<y.length;x++)b=y[x][0].split(",").map(Number),this.positionCololatedLatLng=a.latLng({lat:b[0],lng:b[1]}),this.colocatedLinkDot=this.map.latLngToContainerPoint(this.positionCololatedLatLng),this.colocatedLinksCenterPoint={x:this.colocatedLinkDot.x*this.pixelRatio,y:this.colocatedLinkDot.y*this.pixelRatio},this.drawCircularCircle(y[x][1],this.logicalConnectivityContainer,this.colocatedLinksCenterPoint,this.mainLayerRef,this.positionCololatedLatLng,[{sapId:"I-MU-MUMB_ENB_014",tileName:"Beta_1800_C1"}],b[0],b[1]),this.logicalConnectivityContainer.addChild(this.logicalConnectivityContainer);this.stageLogicalConnectivity.addChild(this.logicalConnectivityContainer),this.stageLogicalConnectivity.update()},this.routeReadyFibreCoreSubscription=this.dataShare.removeLayerMessage.subscribe((function(t){"StructurePlannedFibreCoreComponent"!=t&&"EquipmentsPlannedFibreCoreComponent"!=t||r.removeLayer()})),this.dataShare.mainLayerMessage.subscribe((function(t){r.mainLayerRef=t}))}return t.prototype.ngAfterViewInit=function(){this.pixelRatio=window.devicePixelRatio||1,this.map=this.shapeService.mapServiceData,this.logicalTopology=this.getPopup(),this.logicalConnectivityFibreCoreLayer=new r.a({container:document.createElement("canvas")}),this.map.setView(new a.LatLng(15.60816,73.75113),8);var t=this;this.logicalConnectivityFibreCoreLayer.on("layer-render",(function(){var e=this,n=this,i=this.componentRef=this;t.getLogicalData().subscribe((function(a){e.routePlannedData=a,n.routeFibreCoreLayerContainer=t.resizeContainer(),t.createLayer(n.routeFibreCoreLayerContainer,n._zoom,e.routePlannedData,i,n._assetQueue)}))})),this.logicalConnectivityFibreCoreLayer.addTo(this.map)},t.prototype.resizeContainer=function(){this.canvasCore=this.logicalConnectivityFibreCoreLayer.getContainer();var t=a.Browser.retina?2:1,e=this.logicalConnectivityFibreCoreLayer._bounds.getSize();return this.canvasCore.width=t*e.x,this.canvasCore.height=t*e.y,this.canvasCore.style.width=e.x+"px",this.canvasCore.style.height=e.y+"px",this.canvasCore},t.prototype.getPopup=function(){return a.popup({className:"leaflet-fibre-tooltip",minWidth:120,offset:a.point(0,0),closeButton:!1})},t.prototype.getLogicalData=function(){return this.http.get("assets/data/layers/topologies/Fibre/logical-connectivity/logicalconnectivity.json")},t.prototype.drawStructureImage=function(t,e,n,i,r){var s=i[0].split(",").map(String);null!=s[7]&&(this.positionLatLng=a.latLng(s[7],s[8]),this.linksDot=this.map.latLngToContainerPoint(this.positionLatLng),this.linksCenterPoint={x:this.linksDot.x*this.pixelRatio,y:this.linksDot.y*this.pixelRatio},this.targetLatLng=a.latLng(s[0],s[1]),this.targetLinksDot=this.map.latLngToContainerPoint(this.targetLatLng),this.targetLinksCenterPoint={x:this.targetLinksDot.x*this.pixelRatio,y:this.targetLinksDot.y*this.pixelRatio},this.lineConnectionContainer=new o.Container,this.ConnectionLinkShape=new o.Shape(this.lineCreation(this.targetLinksCenterPoint,this.linksCenterPoint)),this.ConnectionLinkShape.cursor="pointer",this.ConnectionLinkShape.latLng=this.positionLatLng,this.lineConnectionContainer.addChild(this.ConnectionLinkShape),this.logicalConnectivityLineContainer.addChild(this.lineConnectionContainer)),7==s.length?(r="assets/images/Layers/topologies/structure/"+s[2]+".svg",this.positionLatLng=a.latLng(s[0],s[1])):(r="assets/images/Layers/topologies/structure/"+s[9]+".svg",this.positionLatLng=a.latLng(s[7],s[8])),this.linksDot=this.map.latLngToContainerPoint(this.positionLatLng),this.linksCenterPoint={x:this.linksDot.x*this.pixelRatio,y:this.linksDot.y*this.pixelRatio},this.structureContainerEach=new o.Container,this.structureContainerEach.cursor="pointer",this.structureContainerEach.x=this.linksCenterPoint.x,this.structureContainerEach.y=this.linksCenterPoint.y,this.structureContainerEach.scaleX=this.scaleMatrix,this.structureContainerEach.scaleY=this.scaleMatrix,this.structureImage=new o.Bitmap(r),this.structureImage.regX=10,this.structureImage.regY=30,this.structureImage.scaleX=1,this.structureImage.scaleY=1,this.structureImage.latlng=this.positionLatLng,this.structureImage.data=s;var c=this;this.structureImage.image.onload=function(){c.stageLogicalConnectivity.update()},this.structureImage.on("mouseover",(function(t){var e=t.target,n=a.point(t.rawX/c.pixelRatio,t.rawY/c.pixelRatio);e.latlng=c.map.containerPointToLatLng(n);var i="",r="",o="",l="";7==s.length?(r=e.data[4],o=e.data[5],l=e.data[6]):(r=e.data[11],o=e.data[12],l=e.data[13]),i+='<div class="layout-row popup-layout-padding"><span class="prefix">Sector:</span><span class="value">'+r+"</span></div>",i+='<div class="layout-row popup-layout-padding"><span class="prefix">Band:</span><span class="value">'+o+"</span></div>",i+='<div class="layout-row popup-layout-padding"><span class="prefix">cNum:</span><span class="value">'+l+"</span></div>",c.logicalTopology.setLatLng(e.latlng).setContent(i).openOn(c.map)})),this.structureImage.on("mouseout",(function(t){c.map.closePopup()})),this.structureImage.on("click",(function(t){c.openSpider(t,c.mainLayerRef)})),this.structureImageText=new o.Text(7==s.length?s[3]:s[10],"15px Lato Bold","#000000"),this.structureImageText.textAlign="center",this.structureImageText.textBaseLine="middle",this.structureImageText.y=50,this.structureContainerEach.addChild(this.structureImage,this.structureImageText),this.logicalConnectivityCircleContainer.addChild(this.structureContainerEach)},t.prototype.openSpider=function(t,e){var n=e.componentFactoryResolver.resolveComponentFactory(g.a);e.componentRef=e.target.createComponent(n),e.componentRef.instance.colocatedCircleData=[{tileName:t.target.data[3],fontValue:"\uf207",fontFamily:"Material-Design-Iconic-Font",color:"#03a9f4",radiusDeviceCircle:"56"}],e.componentRef.instance.data=this.structureDataLogical,e.componentRef.instance.mainRef=this,e.componentRef.instance.mainLayerReference=this.mainLayerRef},t.prototype.openAdjSpider=function(t,e){console.log(t);var n=e.componentFactoryResolver.resolveComponentFactory(g.a);e.componentRef=e.target.createComponent(n),e.componentRef.instance.colocatedCircleData=[{tileName:t.data.name,fontValue:t.data.fontvalue,fontFamily:t.data.font,color:t.data.color,radiusDeviceCircle:"56"}],e.componentRef.instance.data=this.structureDataLogical,e.componentRef.instance.mainRef=this,e.componentRef.instance.mainLayerReference=this.mainLayerRef},t.prototype.routeClicked=function(){var t=new h.a("Structure");this.dialog.open(h.b,{width:"1200px",height:"500px",position:{left:"18.5rem",top:"4rem"},data:t,hasBackdrop:!1,disableClose:!1,panelClass:"material-dialog-container"})},t.prototype.lineCreation=function(t,e){return this.connectionLinks=new o.Graphics,this.lineStrokeWidth=4*this.scaleMatrix,this.connectionLinks.setStrokeDash([5,3],0),this.connectionLinks.beginStroke(this.linkColor),this.connectionLinks.moveTo(t.x,t.y),this.connectionLinks.lineTo(e.x,e.y),this.connectionLinks.endStroke(),this.connectionLinks.closePath(),this.connectionLinks},t.prototype.drawCircularCircle=function(t,e,n,r,s,c,l,u){this.stageLogicalConnectivity.removeAllChildren(),this.stageLogicalConnectivity.update(),this.circleGraphic=this.drawCircleGraphics("#003B7440",65),this.circleCountShape=new o.Shape(this.circleGraphic),this.circleCountShape.alpha=.4,this.innercircleGraphic=this.drawCircleGraphics("#003A74",21),this.innercircleShape=new o.Shape(this.innercircleGraphic),this.textContainer=new o.Container,this.textContainer.x=n.x,this.textContainer.y=n.y,this.textContainer.latLng=new a.LatLng(l,u),this.labelCount=new o.Bitmap("assets/images/Layers/topologies/structure/All.svg"),this.labelCount.regX=35,this.labelCount.regY=30,this.labelCount.scaleX=.4,this.labelCount.scaleY=.4,this.labelCount.latlng=this.textContainer.latLng;var p=this;this.textContainer.addEventListener("click",(function(e){p.clonedArray=Object(i.h)(p.structureColocatedData),p.clonedArray.splice(t,p.clonedArray.length-t),p.map.setView(s),p.colocatedLogicalConnectivityClicked(e,r,c,p.clonedArray,p.textContainer.latLng)})),this.textContainer.addChild(this.circleCountShape,this.innercircleShape,this.labelCount),e.addChild(this.textContainer),this.stageLogicalConnectivity.update()},t.prototype.colocatedLogicalConnectivityClicked=function(t,e,n,a,r){return Object(i.b)(this,void 0,void 0,(function(){var t;return Object(i.e)(this,(function(i){return t=e.componentFactoryResolver.resolveComponentFactory(f.a),e.componentRef=e.target.createComponent(t),e.componentRef.instance.data=a,e.componentRef.instance.colocatedCircularCircleData=n,e.componentRef.instance.mainRef=this,e.componentRef.instance.mainLayerReference=e,e.componentRef.instance.latlng=r,[2]}))}))},t.prototype.openSpiderCircularPopups=function(t,e,n){var i=e.componentFactoryResolver.resolveComponentFactory(d);e.componentRef=e.target.createComponent(i),e.componentRef.instance.colocatedCircleData=[{tileName:t.data.device,fontValue:t.data.fontvalue,fontFamily:t.data.font,color:t.data.color,radiusDeviceCircle:"56",latLng:n}],e.componentRef.instance.data=this.structureData,e.componentRef.instance.mainRef=this,e.componentRef.instance.mainLayerReference=this.mainLayerRef},t.prototype.openSpiderPopups=function(e,n){if("Structure"==e.data.name){var i=new h.a("Route");this.dialog.open(h.b,{width:"1200px",height:"500px",position:{left:"18.5rem",top:"4rem"},data:i,hasBackdrop:!1,disableClose:!1,panelClass:"material-dialog-container"})}else if("Logical Connectivity"==e.data.name){this.dataShare.setExtraLayer({parentToChild:"Logical-Connectivity",child:"Topologies-Structure-Planned"}),this.dataShare.countLogicalMessage(),this.removeLayer();var a=n.componentFactoryResolver.resolveComponentFactory(t);n.componentRef=n.target.createComponent(a)}},t.prototype.drawCircleGraphics=function(t,e){return this.drawCircleGraphic=new o.Graphics,this.drawCircleGraphic.beginFill(t),this.drawCircleGraphic.drawCircle(0,0,e),this.drawCircleGraphic},t.prototype.removeLayer=function(){null!=this.logicalConnectivityFibreCoreLayer&&this.map.removeLayer(this.logicalConnectivityFibreCoreLayer)},t.prototype.ngOnDestroy=function(){this.routeReadyFibreCoreSubscription&&this.routeReadyFibreCoreSubscription.unsubscribe()},t.\u0275fac=function(e){return new(e||t)(c.Ub(y.a),c.Ub(v.a),c.Ub(m.b),c.Ub(l.b))},t.\u0275cmp=c.Ob({type:t,selectors:[["app-logical-connectivity"]],decls:2,vars:0,template:function(t,e){1&t&&(c.ac(0,"p"),c.Vc(1,"logical-connectivity works!"),c.Zb())},styles:[""]}),t}()},dltC:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("VphZ"),a=n("TYT/"),r=["spiderView"],o=["mapTree"],s=function(){function t(){}return t.prototype.ngAfterViewInit=function(){var t=this.mapTree.nativeElement,e=i.f(this.spiderView.nativeElement);this.circularSpiderViewCreation(t,e,this.data,this)},t.prototype.circularSpiderViewCreation=function(t,e,n,a){var r=this,o=t.offsetWidth,s=t.offsetHeight,c=o>0?o:500,l=s>0?s:500,u=e.append("g").attr("class","wrapper").attr("transform","translate("+(c/2+20)+","+l/2+")");this.data.forEach((function(n){var a=Math.min(c,500)-20-20,o=i.a().innerRadius(.75*a/2).outerRadius(.75*a/2+30),s=i.a().innerRadius(.33*a/2).outerRadius(.33*a/2+30),l=i.d().startAngle(0*Math.PI/360).endAngle(90*Math.PI/360+2*Math.PI).value((function(t){return t.value})).padAngle(.01).sort(null),p=u.append("g").attr("class","bandsArcsGroup");p.append("circle").attr("class","circleOrbit").attr("fill","none").attr("stroke","#000").attr("stroke-opacity",.5).attr("r",n.radiuscircle),p.selectAll("circle").attr("id",(function(t,e){return"circleOrbit"+e}));var d=p.selectAll(".donutArcsGroup").data(l(n.deviceType)).enter().append("g").attr("class","donutArcsGroup");"100"==n.radiuscircle?d.append("path").attr("d",s).style("fill","none").attr("class",(function(t,e){var n=/(^.+?)L/.exec(i.f(this).attr("d"))[1];if(n=n.replace(/,/g," "),t.endAngle>90*Math.PI/180){var a=/0 0 1 (.*?)$/.exec(n)[1],r=/M(.*?)A/.exec(n)[1];n="M"+a+"A"+/A(.*?)0 0 1/.exec(n)[1]+"0 0 0 "+r}return console.log(this.parentNode,"this.parentNode"),i.f(this.parentNode).append("path").attr("class","hiddenDonutArcs").attr("id","donutArcInner"+e).attr("d",n).style("fill","none"),"donutArcsInner"})):d.append("path").attr("d",o).style("fill","none").attr("class",(function(t,e){var n=/(^.+?)L/.exec(i.f(this).attr("d"))[1];if(n=n.replace(/,/g," "),t.endAngle>90*Math.PI/180){var a=/0 0 1 (.*?)$/.exec(n)[1],r=/M(.*?)A/.exec(n)[1];n="M"+a+"A"+/A(.*?)0 0 1/.exec(n)[1]+"0 0 0 "+r}return console.log(this.parentNode,"this.parentNode"),i.f(this.parentNode).append("path").attr("class","hiddenDonutArcs").attr("id","donutArc"+e).attr("d",n).style("fill","none"),"donutArcs"}));var h=p.selectAll(".circleGroup").data(l(n.deviceType)).enter().append("g").style("cursor","pointer").style("pointer-events",(function(t,e){return t.data.disabled?"none":"all"})).attr("class","circleGroup").attr("transform",(function(e,a){if("100"==n.radiuscircle){var r=$(t).find("#donutArcInner"+a)[0];return"translate("+(s=(o=i.f(r).node()).getPointAtLength(o.getTotalLength()/2)).x+","+s.y+")"}var o,s;return r=$(t).find("#donutArc"+a)[0],"translate("+((s=(o=i.f(r).node()).getPointAtLength(o.getTotalLength()/2)).x-20)+","+s.y+")"}));h.append("rect").attr("class","rectPoints").attr("width",40).attr("height",40).attr("rx",4).attr("stroke-width",1).attr("stroke","#FFFFFF").attr("fill",(function(t){return t.data.disabled?"#b3b3b3":t.data.color})).attr("y",(function(t){if("100"==n.radiuscircle)return-25;var e=t.endAngle*(180/Math.PI);return e>=0?-20:e>=90?10:e>=180?20:e>=270?50:-20})).attr("x",(function(t){return"100"==n.radiuscircle?-25:0})),h.append("text").style("text-anchor","start").style("fill","#000").style("color","#000").style("font-size","12px").attr("class","donutText").attr("y",(function(t){if("100"==n.radiuscircle)return 30;var e=t.startAngle*(180/Math.PI);return e<=90||e>=180?35:40})).attr("x",(function(t){return"100"==n.radiuscircle?-20:5})).text((function(t){return t.data.device})),h.append("text").style("text-anchor","middle").style("dominant-baseline","middle").style("fill","#ffffff").style("color","#000").style("font-size","24px").style("margin-top","24px").style("font-family",(function(t){return t.data.font})).attr("x",(function(t){return"100"==n.radiuscircle?-5:20})).attr("y",(function(t){return"100"==n.radiuscircle?-2:3})).attr("class","iconText").text((function(t){return t.data.fontvalue})),h.on("mouseover",(function(){i.f(this).select("rect").transition().attr("stroke","#FFFFFF").attr("stroke-width",2)})).on("mouseout",(function(){i.f(this).select("rect").transition().attr("stroke","#FFFFFF").attr("stroke-width",1)})).on("click",(function(t){r.mainRef.openSpiderCircularPopups(t,r.mainLayerReference,r.latlng)}));var f=p.append("g").attr("id","centerImgGroup").attr("class","cellGroup").attr("transform","translate(-12,-20)").style("cursor","pointer").style("opacity","0.3");f.append("foreignObject").attr({width:30,height:30});var g="";"structure"==r.type?g="assets/images/Layers/topologies/structure/All-structure.svg":"equipment"==r.type&&(g="assets/images/Layers/topologies/structure/all-blue.svg"),f.style("opacity","1"),f.append("svg:image").attr("width",30).attr("height",30).attr("xlink:href",g),e.on("click",(function(){$(t).parent().remove(),i.b.stopPropagation()}))}))},t.prototype.leafSVGMouseOut=function(t,e){this.leafSVG.on("mouseout",function(t,e){return function(){return t.cellid!=e.cellid&&i.f(this).transition().attr("stroke-width",1),!1}}(t,e))},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Ob({type:t,selectors:[["app-fiveg-circular-spider-view"]],viewQuery:function(t,e){var n;1&t&&(a.cd(r,!0),a.cd(o,!0)),2&t&&(a.Hc(n=a.nc())&&(e.spiderView=n.first),a.Hc(n=a.nc())&&(e.mapTree=n.first))},decls:5,vars:0,consts:[[1,"spidermain-wrapper"],[1,"spideroverlay"],["mapTree",""],[1,"spiderview","spider-fiveg-circular"],["spiderView",""]],template:function(t,e){1&t&&(a.ac(0,"div",0),a.ac(1,"div",1,2),a.pc(),a.Vb(3,"svg",3,4),a.Zb(),a.Zb())},styles:[".spidermain-wrapper[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;z-index:10000;top:0;overflow:auto}.spideroverlay[_ngcontent-%COMP%], .spideroverlay[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;overflow:auto}.spideroverlay[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   g[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]{display:inline-block}.spider-fiveg-circular[_ngcontent-%COMP%]{box-shadow:0 0 1rem 0 rgba(0,0,0,.2);border-radius:5px;position:relative!important;z-index:1;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);padding:0;background-color:hsla(0,0%,100%,.4)}"]}),t}()}}]);