(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{OT7S:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var o=i("4R65"),n=i.n(o),a=n.a.Layer.extend({options:{padding:0,tolerance:0,container:null,opacity:1,visible:!0,zIndex:void 0,minZoom:0,maxZoom:18},initialize:function(t){n.a.setOptions(this,t),n.a.stamp(this),this._map=void 0,this._container=void 0,this._bounds=void 0,this._center=void 0,this._zoom=void 0,this._padding=void 0},beforeAdd:function(){this._zoomVisible=!0},getEvents:function(){var t={viewreset:this._onLayerViewReset,zoom:this._onLayerZoom,moveend:this._onLayerMoveEnd,zoomend:this._onLayerZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onLayerAnimZoom),t},onAdd:function(){if(this.fire("layer-beforemount"),this._container||this._initContainer(),this.setOpacity(this.options.opacity),window.isNaN(this.options.zIndex))switch(this._container.tagName){case"CANVAS":this.setZIndex(100);break;case"svg":this.setZIndex(200);break;default:this.setZIndex(100)}else this.setZIndex(this.options.zIndex);this.getPane().appendChild(this._container),this._onZoomVisible(),this.fire("layer-mounted"),this._update()},onRemove:function(){this.fire("layer-beforedestroy"),this._destroyContainer(),this.fire("layer-destroyed")},_onLayerViewReset:function(){this._reset()},_onLayerAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onLayerZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onLayerZoomEnd:function(){},_onLayerMoveEnd:function(){this._isZoomVisible()?this._update():this._zoomHide()},_onZoomVisible:function(){this._isZoomVisible()?this._zoomShow():this._zoomHide()},_initContainer:function(){var t=this._container=this.options.container;n.a.DomUtil.addClass(t,"leaflet-layer"),this._zoomAnimated&&n.a.DomUtil.addClass(this._container,"leaflet-zoom-animated")},_destroyContainer:function(){n.a.DomUtil.remove(this._container),delete this._container},_isZoomVisible:function(){var t=this.options.minZoom,e=this.options.maxZoom,i=this._map.getZoom();return i>=t&&i<=e},_zoomShow:function(){this._zoomVisible||(this._zoomVisible=!0,this._map.off({zoomend:this._onZoomVisible},this),this.options.visible&&(this._map.on(this.getEvents(),this),this.getContainer().style.display=""))},_zoomHide:function(){this._zoomVisible&&(this._zoomVisible=!1,this._map.off(this.getEvents(),this),this._map.on({zoomend:this._onZoomVisible},this),this.getContainer().style.display="none")},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),o=n.a.DomUtil.getPosition(this._container),a=this._map.getSize().multiplyBy(.5+this.options.padding),s=this._map.project(this._center,e),r=this._map.project(t,e).subtract(s),c=a.multiplyBy(-i).add(o).add(a).subtract(r);n.a.Browser.any3d?n.a.DomUtil.setTransform(this._container,c,i):n.a.DomUtil.setPosition(this._container,c)},_update:function(){this._map._animatingZoom&&this._bounds||(this.__update(),n.a.DomUtil.setPosition(this._container,this._bounds.min),this.fire("layer-render"))},__update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t));this._padding=e.multiplyBy(t),this._bounds=new n.a.Bounds(i,i.add(e.multiplyBy(1+2*t))),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom)},getContainer:function(){return this._container},setContainer:function(t){var e=this.getContainer(),i=e.parentNode;if(delete this._container,this.options.container=t,this._container||this._initContainer(),this.setOpacity(this.options.opacity),window.isNaN(this.options.zIndex))switch(this._container.tagName){case"CANVAS":this.setZIndex(100);break;case"svg":this.setZIndex(200);break;default:this.setZIndex(100)}else this.setZIndex(this.options.zIndex);return i?i.replaceChild(t,e):this.getPane().appendChild(t),this._update(),this},getOpacity:function(){return this.options.opacity},setOpacity:function(t){return this.getContainer().style.opacity=this.options.opacity=1*t,this},getZIndex:function(){return this.options.zIndex},setZIndex:function(t){return this.getContainer().style.zIndex=this.options.zIndex=1*t,this},show:function(){if(!this.options.visible){if(this.options.visible=!0,this._isZoomVisible())return this._map.on(this.getEvents(),this),this.getContainer().style.display="",this._update(),this;this._zoomHide()}},hide:function(){if(this.options.visible)return this.options.visible=!1,this._zoomHide(),this._map.off(this.getEvents(),this),this.getContainer().style.display="none",this},setFullLayerBounds:function(){var t=this.getContainer(),e=this._bounds.getSize(),i=this._padding;switch(t.tagName){case"CANVAS":var o=n.a.Browser.retina?2:1;t.width=o*e.x,t.height=o*e.y,t.style.width=e.x+"px",t.style.height=e.y+"px";var a=t.getContext("2d");return n.a.Browser.retina&&a.scale(o,o),a.translate(i.x,i.y),{container:t,ctx:a,dpr:o};case"svg":return t.setAttribute("width",e.x),t.setAttribute("height",e.y),t.style.width=e.x+"px",t.style.height=e.y+"px",t.setAttribute("viewBox","".concat(-i.x," ").concat(-i.y," ").concat(e.x," ").concat(e.y)),{container:t};case"DIV":return t.style.boxSizing="content-box",t.style.width=e.x-i.x+"px",t.style.height=e.y-i.y+"px",t.style.padding="".concat(i.y,"px ").concat(i.x,"px"),{container:t};default:return t.setAttribute("width",e.x),t.setAttribute("height",e.y),t.style.width=e.x+"px",t.style.height=e.y+"px",{container:t}}}});n.a.CustomLayer=a,n.a.customLayer=function(t){return n.a.customLayer?new a(t):null}},npsI:function(t,e,i){"use strict";i.r(e),i.d(e,"MacroLayerComponent",(function(){return b}));var o=i("4R65"),n=i("OT7S"),a=i("ZWlK"),s=i("ea4N"),r=i("TYT/"),c=i("DUip"),h=i("FfOm"),l=i("uLXW"),u=i("p+mS"),d=i("GsDI"),p=i("XIAg"),m=function(){function t(t,e){this.dialogRef=t,this.router=e,this.selectedRadio="Capacity"}return t.prototype.ngOnInit=function(){},t.prototype.routeAction=function(){this.router.navigate("Capacity"==this.selectedRadio?["/JCP/Modules/Planning-Deployment/Nominal-Capacity/Create-Nominal-Task"]:"Coverage"==this.selectedRadio?["/JCP/Modules/Planning-Deployment/Nominal-Generation/Create"]:["/JCP/Modules/Network-Planning/RF-Planning/Nominal-Strategic"]),this.dialogRef.close(!0)},t.prototype.closeDialog=function(){this.dialogRef.close(!0)},t.\u0275fac=function(e){return new(e||t)(r.Ub(s.g),r.Ub(c.b))},t.\u0275cmp=r.Ob({type:t,selectors:[["app-nc-site-details-dialog"]],decls:75,vars:0,consts:[[1,"nc-site-details-popup-dialog"],[1,"dialog-header"],["fxFlex","grow"],["mat-icon-button","",1,"dialog-close-button",3,"click"],["fxLayout","column","fxLayoutAlign","space-evenly stretch",1,"containerDiv"],["fxLayout","row"],["fxFlex","35","fxLayout","row"],[1,"latLongLabel"],[1,"latLongValue"],["fxFlex","50","fxLayout","row"],["fxLatout","row"],["fxFlex","20"],[1,"label"],[1,"value"],["fxFlex","25"],["fxFlex","15"]],template:function(t,e){1&t&&(r.ac(0,"div",0),r.ac(1,"mat-toolbar",1),r.ac(2,"mat-toolbar-row"),r.ac(3,"div",2),r.ac(4,"div"),r.Vc(5,"Site ID"),r.Zb(),r.Zb(),r.ac(6,"button",3),r.mc("click",(function(){return e.closeDialog()})),r.ac(7,"mat-icon"),r.Vc(8,"close"),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Vb(9,"mat-divider"),r.ac(10,"div",4),r.ac(11,"div",5),r.ac(12,"div",6),r.ac(13,"div",7),r.Vc(14," Grid Latitude : "),r.Zb(),r.ac(15,"div",8),r.Vc(16," 18.6304301718391 "),r.Zb(),r.Zb(),r.ac(17,"div",9),r.ac(18,"div",7),r.Vc(19," Grid Longitude : "),r.Zb(),r.ac(20,"div",8),r.Vc(21," 73.848192745904 "),r.Zb(),r.Zb(),r.Zb(),r.ac(22,"div",10),r.ac(23,"div",11),r.ac(24,"div",12),r.Vc(25," Candidate Category "),r.Zb(),r.ac(26,"div",13),r.Vc(27," 4G Site "),r.Zb(),r.Zb(),r.ac(28,"div",14),r.ac(29,"div",12),r.Vc(30," Candidate SAP ID "),r.Zb(),r.ac(31,"div",13),r.Vc(32," I-MH-CWAD-ENB-I072 "),r.Zb(),r.Zb(),r.ac(33,"div",11),r.ac(34,"div",12),r.Vc(35," Site Priority "),r.Zb(),r.ac(36,"div",13),r.Vc(37," IP1 "),r.Zb(),r.Zb(),r.ac(38,"div",11),r.ac(39,"div",12),r.Vc(40," Backhaul Type "),r.Zb(),r.ac(41,"div",13),r.Vc(42," MW "),r.Zb(),r.Zb(),r.ac(43,"div",15),r.ac(44,"div",12),r.Vc(45," Tower Type "),r.Zb(),r.ac(46,"div",13),r.Vc(47," RTT "),r.Zb(),r.Zb(),r.Zb(),r.Vb(48,"mat-divider"),r.ac(49,"div",10),r.ac(50,"div",11),r.ac(51,"div",12),r.Vc(52," Traffic (in GB) "),r.Zb(),r.ac(53,"div",13),r.Vc(54," 624.361961559791 "),r.Zb(),r.Zb(),r.ac(55,"div",14),r.ac(56,"div",12),r.Vc(57," Budget Handset Users "),r.Zb(),r.ac(58,"div",13),r.Vc(59," 27284 "),r.Zb(),r.Zb(),r.ac(60,"div",11),r.ac(61,"div",12),r.Vc(62," 1234 "),r.Zb(),r.ac(63,"div",13),r.Vc(64," 4G Site "),r.Zb(),r.Zb(),r.ac(65,"div",11),r.ac(66,"div",12),r.Vc(67," 2675 "),r.Zb(),r.ac(68,"div",13),r.Vc(69," 4G Site "),r.Zb(),r.Zb(),r.ac(70,"div",15),r.ac(71,"div",12),r.Vc(72," Cluter "),r.Zb(),r.ac(73,"div",13),r.Vc(74," Urban "),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb())},directives:[h.a,h.c,l.a,u.b,d.a,p.a,l.c,l.b],styles:[".nc-site-details-popup-dialog{background:#fff;height:100%}.nc-site-details-popup-dialog .dialog-header{background-color:#fff}.nc-site-details-popup-dialog .containerDiv{margin:10px 20px;height:165px}.nc-site-details-popup-dialog .containerDiv .latLongLabel{font-size:14px}.nc-site-details-popup-dialog .containerDiv .latLongValue{font-size:14px;color:#020202;opacity:1%}.nc-site-details-popup-dialog .containerDiv .label{font-size:12px;color:#000;opacity:1%}.nc-site-details-popup-dialog .containerDiv .value{font-size:14px;color:#000;opacity:1%}"],encapsulation:2}),t}(),g=function(){return function(){}}(),v=i("i+93"),y=i("cUzu"),f=i("RaP5"),C=function(){function t(t,e,i,n,s,r){var c=this;this.shapeService=t,this.http=e,this.dataShare=i,this.dialog=n,this.dialogRef=s,this.data=r,this.allLinePoints=[],this.allPoints=[],this.allPoints1=[],this.structureData=[{name:"Structure",value:5,color:"#03A9F4",font:"icomoon",fontvalue:"\uec84",eventname:"sites-tree-candidates-nominals",sapid:"I-MU-MUMB_ENB_I164"},{name:"Logical Connectivity",value:5,color:"#03A9F4",font:"icomoon",fontvalue:"\uec82",eventname:"sites-tree-candidates-nominals",sapid:"I-MU-MUMB_ENB_I174"}],this.structureColocatedData=[{name:"Properties",value:5,color:"#8CC63F",font:"icomoon",fontvalue:"\uec6b",frequency:.01492,eventname:"sites-tree-properties",radiuscircle:200,deviceType:[{device:"AG3",color:"#94C65A",font:"icomoon",fontvalue:"\uec6c",value:5},{device:"AG2+ONT",color:"#94C65A",font:"icomoon",fontvalue:"\uec6d",value:5},{device:"eNodeB",color:"#94C65A",font:"icomoon",fontvalue:"\uec6f",value:5},{device:"Fiber-Pop",color:"#94C65A",font:"icomoon",fontvalue:"\uec70",value:5},{device:"ILA",color:"#03A9F4",font:"icomoon",fontvalue:"\uec71",value:5},{device:"Manhole",color:"#03A9F4",font:"icomoon",fontvalue:"\uec72",value:5},{device:"OSC",color:"#94C65A",font:"icomoon",fontvalue:"\uec73",value:5},{device:"Pole",color:"#94C65A",font:"icomoon",fontvalue:"\uec74",value:5},{device:"ISC",color:"#03A9F4",font:"icomoon",fontvalue:"\uec87",value:5}]},{name:"Create Workorder",value:5,color:"#8dc63f",font:"icomoon",fontvalue:"\uec6a",disabled:!0,frequency:.02782,radiuscircle:100,eventname:"sites-tree-createworkorder",deviceType:[{device:"AG1",color:"#94C65A",font:"icomoon",fontvalue:"\uec6a",value:5},{device:"SAG2",color:"#94C65A",font:"icomoon",fontvalue:"\uec75",value:5},{device:"Pole",color:"#94C65A",font:"icomoon",fontvalue:"\uec74",value:5},{device:"Others",color:"#03A9F4",font:"icomoon",fontvalue:"\uec85",value:5},{device:"IBS",color:"#94C65A",font:"icomoon",fontvalue:"\uec86",value:5}]}],this.createLayer=function(t,e,i,n,s){this.lineColors="red",this.allLinePoints=[],this.zoomLevel=e,this.scaleMatrix=this.zoomLevel<=7?.4:this.zoomLevel<=10?.5:this.zoomLevel<=13?.75:this.zoomLevel<=15?.5:.75,this.scaleMatrix=this.scaleMatrix*this.pixelRatio,null!=this.stageRouteContainer&&(this.stageRouteContainer.removeAllChildren(),this.stageRouteContainer.update()),this.stageRouteContainer=new a.Stage(t),this.stageRouteContainer.enableDOMEvents(!0),this.stageRouteContainer.enableMouseOver(5e4),this.stageRouteContainer.removeAllChildren(),this._assetQueue=new a.LoadQueue(!1,null,!0),this._assetQueue.loadManifest(this._plannedSiteImageManifest,!0),this.structureContainer1=new a.Container,this.structureContainer=new a.Container;for(var r=i[0].connectivity,c=[],h=0;h<r.length;h++)this.drawStructureImage(this.structureContainer,r[h]),c.push(r[h]);this.positionLatLng=o.latLng(c[0].latlng[0],c[0].latlng[1]),this.linksDot=this.mapSix.latLngToContainerPoint(this.positionLatLng),this.linksCenterPoint={x:this.linksDot.x*this.pixelRatio,y:this.linksDot.y*this.pixelRatio},this.targetLatLng=o.latLng(c[1].latlng[0],c[1].latlng[1]),this.targetLinksDot=this.mapSix.latLngToContainerPoint(this.targetLatLng),this.targetLinksCenterPoint={x:this.targetLinksDot.x*this.pixelRatio,y:this.targetLinksDot.y*this.pixelRatio},this.lineConnectionContainer=new a.Container,this.ConnectionLinkShape=new a.Shape(this.lineCreation(this.linksCenterPoint,this.targetLinksCenterPoint)),this.ConnectionLinkShape.cursor="pointer",this.ConnectionLinkShape.latLng=this.positionLatLng,this.lineConnectionContainer.addChild(this.ConnectionLinkShape),this.structureContainer1.addChild(this.lineConnectionContainer,this.structureContainer),this.stageRouteContainer.addChild(this.structureContainer1),this.stageRouteContainer.update()},this.routeReadyFibreCoreSubscription=this.dataShare.removeLayerMessage.subscribe((function(t){"StructurePlannedFibreCoreComponent"==t&&(c.dataShare.removeExtraLayer({parentToChild:"Logical-Connectivity",child:"Topologies-Structure-Planned"}),c.removeLayer())})),this.dataShare.mainLayerMessage.subscribe((function(t){c.mainLayerRef=t}))}return t.prototype.ngAfterViewInit=function(){this.initMapSite(),this.pixelRatio=window.devicePixelRatio||1,this.structurePopup=this.getPopup(),this.map=this.shapeService.mapServiceData,this.routeFibreCoreLayer=new n.a({container:document.createElement("canvas")}),this.mapSix.setView(this.data.latlng,this.data.zoom);var t=this;this.routeFibreCoreLayer.on("layer-render",(function(){var e=this,i=this,o=this.componentRef=this;t.getRouteData().subscribe((function(n){e.routePlannedData=n,i.routeFibreCoreLayerContainer=t.resizeContainer(),t.createLayer(i.routeFibreCoreLayerContainer,i._zoom,e.routePlannedData,o,i._assetQueue)}))})),this.routeFibreCoreLayer.addTo(this.mapSix)},t.prototype.getRouteData=function(){return this.http.get("assets/data/layers/nominal-capacity/macro-layer.json")},t.prototype.getPopup=function(){return o.popup({className:"leaflet-fibre-tooltip",minWidth:120,offset:o.point(0,0),closeButton:!1})},t.prototype.resizeContainer=function(){this.canvasCore=this.routeFibreCoreLayer.getContainer();var t=o.Browser.retina?2:1,e=this.routeFibreCoreLayer._bounds.getSize();return this.canvasCore.width=t*e.x,this.canvasCore.height=t*e.y,this.canvasCore.style.width=e.x+"px",this.canvasCore.style.height=e.y+"px",this.canvasCore},t.prototype.drawStructureImage=function(t,e){var i;i="assets/images/Layers/topologies/structure/"+e.type+".svg",this.positionLatLng=o.latLng(e.latlng[0],e.latlng[1]),this.linksDot=this.mapSix.latLngToContainerPoint(this.positionLatLng),this.linksCenterPoint={x:this.linksDot.x*this.pixelRatio,y:this.linksDot.y*this.pixelRatio},this.structureContainerEach=new a.Container,this.structureContainerEach.cursor="pointer",this.structureContainerEach.x=this.linksCenterPoint.x,this.structureContainerEach.y=this.linksCenterPoint.y,this.structureContainerEach.scaleX=this.scaleMatrix,this.structureContainerEach.scaleY=this.scaleMatrix,this.structureImage=new a.Bitmap(i),this.structureImage.regX=10,this.structureImage.regY=30,this.structureImage.scaleX=1,this.structureImage.scaleY=1,this.structureImage.latlng=this.positionLatLng,this.structureImage.data=e;var n=this;this.structureImage.image.onload=function(){var t=o.point((n.linksCenterPoint.x+n.targetLinksCenterPoint.x)/2*n.pixelRatio,(n.linksCenterPoint.y+n.targetLinksCenterPoint.y)/2*n.pixelRatio),e=n.mapSix.containerPointToLatLng(t);n.structurePopup.setLatLng(e).setContent('<div class="layout-row popup-layout-padding"><span class="prefix">Sector:</span><span class="value">789</span></div>').openOn(n.mapSix),n.stageRouteContainer.update()},this.structureImage.on("click",(function(t){var e=new g;this.dialog.open(m,{data:e,width:"1000px",height:"250px",panelClass:"nc-site-details-popup-dialog"})})),this.structureImageText=new a.Text(e.sapid,"15px Lato Bold","#000000"),this.structureImageText.textAlign="center",this.structureImageText.textBaseLine="middle",this.structureImageText.y=50,this.structureContainerEach.addChild(this.structureImage,this.structureImageText),t.addChild(this.structureContainerEach)},t.prototype.removeLayer=function(){null!=this.routeFibreCoreLayer&&this.mapSix.removeLayer(this.routeFibreCoreLayer)},t.prototype.initMapSite=function(){this.mapSix=o.map("map11",{center:[19.0522,72.9005],zoomControl:!1,zoom:15}),o.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"],opacity:0}).addTo(this.mapSix),this.shapeService.mapServiceData=this.mapSix},t.prototype.ngOnDestroy=function(){this.routeReadyFibreCoreSubscription&&this.routeReadyFibreCoreSubscription.unsubscribe()},t.prototype.lineCreation=function(t,e){return this.connectionLinks=new a.Graphics,this.lineStrokeWidth=1.2,this.connectionLinks.setStrokeDash([5,3],0),this.connectionLinks.beginStroke("#1278D7"),this.connectionLinks.moveTo(t.x,t.y),this.connectionLinks.lineTo(e.x,e.y),this.connectionLinks.endStroke(),this.connectionLinks.closePath(),this.connectionLinks},t.prototype.onClick=function(){this.dialogRef.close()},t.\u0275fac=function(e){return new(e||t)(r.Ub(v.a),r.Ub(y.b),r.Ub(f.a),r.Ub(s.b),r.Ub(s.g),r.Ub(s.a))},t.\u0275cmp=r.Ob({type:t,selectors:[["app-hover-component"]],decls:3,vars:0,consts:[[2,"height","100%",3,"click"],["hoverDiv",""],["id","map11"]],template:function(t,e){1&t&&(r.ac(0,"div",0,1),r.mc("click",(function(){return e.onClick()})),r.Vb(2,"div",2),r.Zb())},styles:[".hover-component{max-width:100%!important;background-color:#fff!important;opacity:.8}#map11{height:100%}"],encapsulation:2}),t}(),b=function(){function t(t,e,i,o){var n=this;this.shapeService=t,this.http=e,this.dataShare=i,this.dialog=o,this.allPoints=[],this.allPoints1=[],this.createLayer=function(t,e,i,o){this.zoomLevel=e,this.scaleMatrix=this.zoomLevel<=7?.4:this.zoomLevel<=10?.5:this.zoomLevel<=13?.75:this.zoomLevel<=15?.5:.75,this.scaleMatrix=this.scaleMatrix*this.pixelRatio,null!=this.macroContainer&&(this.macroContainer.removeAllChildren(),this.macroContainer.update()),this.macroContainer=new a.Stage(t),this.macroContainer.enableDOMEvents(!0),this.macroContainer.enableMouseOver(5e4),this.macroContainer.removeAllChildren(),this._assetQueue=new a.LoadQueue(!1,null,!0),this._assetQueue.loadManifest(this._plannedSiteImageManifest,!0),this.macroImageContainer=new a.Container;for(var n=0;n<i.length;n++){for(var s=0;s<i[n][4].boundary.length;s++)for(var r in this.allPoints["'"+i[n][1].rj_r4g_state_name+"'"]=[],this.allPoints1["'"+i[n][1].rj_r4g_state_name+"'"]=[],i[n][4].boundary[s])for(var c=0;c<i[n][4].boundary[s][r].length;c++)this.allPoints["'"+i[n][1].rj_r4g_state_name+"'"].push([i[n][4].boundary[s][r][c].latlng[0],i[n][4].boundary[s][r][c].latlng[1]]),this.allPoints1["'"+i[n][1].rj_r4g_state_name+"'"].push([i[n][4].boundary[s][r][c].latlng[0],i[n][4].boundary[s][r][c].latlng[1],i[n][4].boundary[s][r][c].sector,i[n][4].boundary[s][r][c].band,i[n][4].boundary[s][r][c].cnum,i[n][4].boundary[s][r][c].sapid,i[n][4].boundary[s][r][c].type]);var h={},l={};this.allPoints["'"+i[n][1].rj_r4g_state_name+"'"].forEach((function(t){h[t]=(h[t]||0)+1,h[t]>1&&(l[t]=h[t])}));var u={},d={};this.allPoints1["'"+i[n][1].rj_r4g_state_name+"'"].forEach((function(t){u[t]=(u[t]||0)+1,d[t]=u[t]}))}for(var p=Object.entries(l),m=Object.entries(d),g=[],v=0;v<p.length;v++)for(var y=p[v][0].split(",").map(Number),f=0;f<m.length;f++){var C=m[f][0].split(",").map(String);C[0]!=y[0]&&C[1]!=y[1]&&g.push(m[f])}for(var b=0;b<g.length;b++)this.drawMacroImage(this.macroImageContainer,g[b],this.mainLayerRef);this.macroContainer.addChild(this.macroImageContainer),this.macroContainer.update()},this.macroLayerSubscription=this.dataShare.removeLayerMessage.subscribe((function(t){"MacroLayerComponent"==t&&n.removeLayer()})),this.dataShare.mainLayerMessage.subscribe((function(t){n.mainLayerRef=t,console.log(n.mainLayerRef)}))}return t.prototype.ngAfterViewInit=function(){this.pixelRatio=window.devicePixelRatio||1,this.map=this.shapeService.mapServiceData,this.macroPopup=this.getPopup(),this.macroLayer=new n.a({container:document.createElement("canvas")}),this.map.setView(new o.LatLng(15.620236,73.729269),9);var t=this;this.macroLayer.on("layer-render",(function(){var e=this,i=this,o=this.componentRef=this;t.getMacroLayerData().subscribe((function(n){e.macroData=n,i.macroLayerContainer=t.resizeContainer(),t.createLayer(i.macroLayerContainer,i._zoom,e.macroData,o)}))})),this.macroLayer.addTo(this.map)},t.prototype.drawMacroImage=function(t,e,i){console.log(e);var n=e[0].split(",").map(String);this.positionLatLng=o.latLng(n[0],n[1]),this.linksDot=this.map.latLngToContainerPoint(this.positionLatLng),this.linksCenterPoint={x:this.linksDot.x*this.pixelRatio,y:this.linksDot.y*this.pixelRatio},this.macroContainerEach=new a.Container,this.macroContainerEach.cursor="pointer",this.macroContainerEach.x=this.linksCenterPoint.x,this.macroContainerEach.y=this.linksCenterPoint.y,this.macroContainerEach.scaleX=this.scaleMatrix,this.macroContainerEach.scaleY=this.scaleMatrix,this.macroImage=new a.Bitmap("assets/images/Layers/topologies/structure/FiberPop.svg"),this.macroImage.regX=10,this.macroImage.regY=30,this.macroImage.scaleX=1,this.macroImage.scaleY=1,this.macroImage.latlng=this.positionLatLng,this.macroImage.data=e;var s=this;this.macroImage.image.onload=function(){s.macroContainer.update()},this.macroImageText=new a.Text(n[5],"15px Lato Bold","#000000"),this.macroImageText.textAlign="center",this.macroImageText.textBaseLine="middle",this.macroImageText.y=50,this.macroImage.on("mouseover",(function(t){var e=t.target,i=o.point(t.rawX/s.pixelRatio,t.rawY/s.pixelRatio);e.latlng=s.map.containerPointToLatLng(i),s.dialog.open(C,{width:screen.width+"px",height:screen.height+"px",data:{zoom:s.zoomLevel,latlng:s.map.getCenter()},hasBackdrop:!1,disableClose:!0,panelClass:"hover-component"})})),this.macroImage.on("mouseout",(function(t){s.map.closePopup()})),this.macroImage.on("click",(function(t){})),this.macroContainerEach.addChild(this.macroImage,this.macroImageText),t.addChild(this.macroContainerEach)},t.prototype.getPopup=function(){return o.popup({className:"leaflet-fibre-tooltip",minWidth:120,offset:o.point(0,0),closeButton:!1})},t.prototype.getMacroLayerData=function(){return this.http.get("assets/data/layers/topologies/Fibre/structure/structure.json")},t.prototype.resizeContainer=function(){this.canvasCore=this.macroLayer.getContainer();var t=o.Browser.retina?2:1,e=this.macroLayer._bounds.getSize();return this.canvasCore.width=t*e.x,this.canvasCore.height=t*e.y,this.canvasCore.style.width=e.x+"px",this.canvasCore.style.height=e.y+"px",this.canvasCore},t.prototype.removeLayer=function(){null!=this.macroLayer&&this.map.removeLayer(this.macroLayer)},t.prototype.ngOnDestroy=function(){this.macroLayerSubscription&&this.macroLayerSubscription.unsubscribe()},t.\u0275fac=function(e){return new(e||t)(r.Ub(v.a),r.Ub(y.b),r.Ub(f.a),r.Ub(s.b))},t.\u0275cmp=r.Ob({type:t,selectors:[["app-macro-layer"]],decls:2,vars:0,template:function(t,e){1&t&&(r.ac(0,"p"),r.Vc(1,"macro-layer works!"),r.Zb())},styles:[""]}),t}()}}]);