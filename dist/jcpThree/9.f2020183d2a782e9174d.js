(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"6iOx":function(e,t,a){"use strict";a.r(t),a.d(t,"NominalGenerationLayerComponent",(function(){return y}));var i=a("mrSG"),o=a("4R65"),n=a("OT7S"),r=a("ZWlK"),s=a("D4RW"),c=a("Kpmo"),l=a("+X4V"),u=a("dltC"),h=a("JR3O"),p=a("TYT/"),d=a("i+93"),g=a("cUzu"),m=a("RaP5"),v=a("ea4N"),C=a("DUip"),y=function(){function e(e,t,a,i,s){var c=this;this.shapeService=e,this.http=t,this.dataShare=a,this.dialog=i,this.router=s,this.allLinePoints=[],this.allPoints=[],this.allPoints1=[],this.structureData=[{name:"Structure",value:5,color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf207",eventname:"sites-tree-candidates-nominals",sapid:"I-MU-MUMB_ENB_I164"},{name:"Logical Connectivity",value:5,color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf207",eventname:"sites-tree-candidates-nominals",sapid:"I-MU-MUMB_ENB_I174"}],this.structureColocatedData=[{name:"Properties",value:5,color:"#8CC63F",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",frequency:.01492,eventname:"sites-tree-properties",radiuscircle:200,deviceType:[{device:"css router",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"L2 Switch",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"AG1 Router",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"OLT",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"Splitter 2",color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"OTB",color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"L2 Switch",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5},{device:"AG1 Router",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf112",value:5}]},{name:"Create Workorder",value:5,color:"#8dc63f",font:"Material-Design-Iconic-Font",fontvalue:"\uf222",disabled:!0,frequency:.02782,radiuscircle:100,eventname:"sites-tree-createworkorder",deviceType:[{device:"L2 Switch",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf222",value:5},{device:"AG1 Router",color:"#94C65A",font:"Material-Design-Iconic-Font",fontvalue:"\uf222",value:5},{device:"Splitter 2",color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf222",value:5},{device:"OTB",color:"#03A9F4",font:"Material-Design-Iconic-Font",fontvalue:"\uf222",value:5}]}],this.routePlannedLayerHeader={title:"Back To Nominal Generation",headerSapid:"Maharashtra-NP-CV-121020_v1"},this.createLayer=function(e,t,a,i,n){var s=this.mainLayerRef.componentFactoryResolver.resolveComponentFactory(h.a);this.mainLayerRef.componentRef=this.mainLayerRef.target.createComponent(s),this.mainLayerRef.componentRef.instance.headerData=this.routePlannedLayerHeader,this.lineColors="red",this.allLinePoints=[],this.zoomLevel=t,this.scaleMatrix=this.zoomLevel<=7?.4:this.zoomLevel<=10?.5:this.zoomLevel<=13?.75:this.zoomLevel<=15?.5:.75,this.scaleMatrix=this.scaleMatrix*this.pixelRatio,null!=this.stageRouteContainer&&(this.stageRouteContainer.removeAllChildren(),this.stageRouteContainer.update()),this.stageRouteContainer=new r.Stage(e),this.stageRouteContainer.enableDOMEvents(!0),this.stageRouteContainer.enableMouseOver(5e4),this.stageRouteContainer.removeAllChildren(),this._assetQueue=new r.LoadQueue(!1,null,!0),this._assetQueue.loadManifest(this._plannedSiteImageManifest,!0),this.structureContainer=new r.Container;for(var c=0;c<a.length;c++){for(var l=0;l<a[c][4].boundary.length;l++)for(var u in this.allPoints["'"+a[c][1].rj_r4g_state_name+"'"]=[],this.allPoints1["'"+a[c][1].rj_r4g_state_name+"'"]=[],a[c][4].boundary[l])for(var p=0;p<a[c][4].boundary[l][u].length;p++)this.allPoints["'"+a[c][1].rj_r4g_state_name+"'"].push([a[c][4].boundary[l][u][p].latlng[0],a[c][4].boundary[l][u][p].latlng[1]]),this.allPoints1["'"+a[c][1].rj_r4g_state_name+"'"].push([a[c][4].boundary[l][u][p].latlng[0],a[c][4].boundary[l][u][p].latlng[1],a[c][4].boundary[l][u][p].sector,a[c][4].boundary[l][u][p].band,a[c][4].boundary[l][u][p].cnum,a[c][4].boundary[l][u][p].sapid,a[c][4].boundary[l][u][p].type]);var d={},g={};this.allPoints["'"+a[c][1].rj_r4g_state_name+"'"].forEach((function(e){d[e]=(d[e]||0)+1,d[e]>1&&(g[e]=d[e])}));var m={},v={};this.allPoints1["'"+a[c][1].rj_r4g_state_name+"'"].forEach((function(e){m[e]=(m[e]||0)+1,v[e]=m[e]}))}for(var C=Object.entries(g),y=Object.entries(v),f=[],L=0;L<C.length;L++)for(var b=C[L][0].split(",").map(Number),R=0;R<y.length;R++){var x=y[R][0].split(",").map(String);x[0]!=b[0]&&x[1]!=b[1]&&f.push(y[R])}for(var w=0;w<f.length;w++)this.drawStructureImage(this.positionLatLng,this.linksCenterPoint,this.structureContainer,f[w],this.imagePath);for(L=0;L<C.length;L++)b=C[L][0].split(",").map(Number),this.positionCololatedLatLng=o.latLng({lat:b[0],lng:b[1]}),this.colocatedLinkDot=this.map.latLngToContainerPoint(this.positionCololatedLatLng),this.colocatedLinksCenterPoint={x:this.colocatedLinkDot.x*this.pixelRatio,y:this.colocatedLinkDot.y*this.pixelRatio},this.drawCircularCircle(C[L][1],this.structureContainer,this.colocatedLinksCenterPoint,this.mainLayerRef,this.positionCololatedLatLng,[{sapId:"I-MU-MUMB_ENB_014",tileName:"Beta_1800_C1"}],b[0],b[1]),this.stageRouteContainer.addChild(this.structureContainer);console.log(this.structureContainer),this.stageRouteContainer.addChild(this.structureContainer),this.stageRouteContainer.update()},this.dataShare.layerNameFunc([{name:"Back To Nominal Geneartion",source:"create"}]),this.routeReadyFibreCoreSubscription=this.dataShare.removeLayerMessage.subscribe((function(e){"StructurePlannedFibreCoreComponent"==e&&(c.dataShare.removeExtraLayer({parentToChild:"Logical-Connectivity",child:"Topologies-Structure-Planned"}),c.removeLayer())})),this.dataShare.mainLayerMessage.subscribe((function(e){c.mainLayerRef=e})),this.dataShare.pinLayerCheck({name:"nominal-generation-layer"}),this.pixelRatio=window.devicePixelRatio||1,this.structurePopup=this.getPopup(),this.map=this.shapeService.mapServiceData,this.routeFibreCoreLayer=new n.a({container:document.createElement("canvas")}),this.map.setZoom(4);var l=this;this.routeFibreCoreLayer.on("layer-render",(function(){var e=this,t=this,a=this.componentRef=this;l.getRouteData().subscribe((function(i){e.routePlannedData=i,t.routeFibreCoreLayerContainer=l.resizeContainer(),l.createLayer(t.routeFibreCoreLayerContainer,t._zoom,e.routePlannedData,a,t._assetQueue)}))})),this.routeFibreCoreLayer.addTo(this.map)}return e.prototype.ngOnInit=function(){},e.prototype.getRouteData=function(){return this.http.get("assets/data/layers/topologies/Fibre/structure/structure.json")},e.prototype.getPopup=function(){return o.popup({className:"leaflet-fibre-tooltip",minWidth:120,offset:o.point(0,0),closeButton:!1})},e.prototype.resizeContainer=function(){this.canvasCore=this.routeFibreCoreLayer.getContainer();var e=o.Browser.retina?2:1,t=this.routeFibreCoreLayer._bounds.getSize();return this.canvasCore.width=e*t.x,this.canvasCore.height=e*t.y,this.canvasCore.style.width=t.x+"px",this.canvasCore.style.height=t.y+"px",this.canvasCore},e.prototype.drawStructureImage=function(e,t,a,i,n){n="";var s=i[0].split(",").map(String);this.zoomLevel<=4?n="assets/images/Layers/topologies/structure/AG3.svg":this.zoomLevel>4&&this.zoomLevel<=6?n="AG2"==s[6]?"assets/images/Layers/topologies/structure/AG2.svg":"assets/images/Layers/topologies/structure/AG2+OTN.svg":this.zoomLevel>6&&this.zoomLevel<=7?n="assets/images/Layers/topologies/structure/AG1.svg":this.zoomLevel>7&&this.zoomLevel<=11?n="SAG2"==s[6]?"assets/images/Layers/topologies/structure/SAG2.svg":"ILA"==s[6]?"assets/images/Layers/topologies/structure/ILA.svg":"Pole"==s[6]?"assets/images/Layers/topologies/structure/Pole.svg":"ManHole"==s[6]?"assets/images/Layers/topologies/structure/ManHole.svg":"FiberPop"==s[6]?"assets/images/Layers/topologies/structure/FiberPop.svg":"assets/images/Layers/topologies/structure/AG1.svg":this.zoomLevel>11&&(n="OSC"==s[6]?"assets/images/Layers/topologies/structure/OSC.svg":"eNodeB"==s[6]?"assets/images/Layers/topologies/structure/eNodeB.svg":"assets/images/Layers/topologies/structure/Others.svg"),this.positionLatLng=o.latLng(s[0],s[1]),this.linksDot=this.map.latLngToContainerPoint(this.positionLatLng),this.linksCenterPoint={x:this.linksDot.x*this.pixelRatio,y:this.linksDot.y*this.pixelRatio},this.structureContainerEach=new r.Container,this.structureContainerEach.cursor="pointer",this.structureContainerEach.x=this.linksCenterPoint.x,this.structureContainerEach.y=this.linksCenterPoint.y,this.structureContainerEach.scaleX=this.scaleMatrix,this.structureContainerEach.scaleY=this.scaleMatrix,this.structureImage=new r.Bitmap(n),this.structureImage.regX=10,this.structureImage.regY=30,this.structureImage.scaleX=1,this.structureImage.scaleY=1,this.structureImage.latlng=this.positionLatLng,this.structureImage.data=s,this.structureImage.image.onload=function(){c.stageRouteContainer.update()},this.structureImageText=new r.Text(s[5],"15px Lato Bold","#000000"),this.structureImageText.textAlign="center",this.structureImageText.textBaseLine="middle",this.structureImageText.y=50;var c=this;this.structureImage.on("mouseover",(function(e){var t=e.target,a=o.point(e.rawX/c.pixelRatio,e.rawY/c.pixelRatio);t.latlng=c.map.containerPointToLatLng(a);var i="";i+='<div class="layout-row popup-layout-padding"><span class="prefix">Sector:</span><span class="value">'+t.data[2]+"</span></div>",i+='<div class="layout-row popup-layout-padding"><span class="prefix">Band:</span><span class="value">'+t.data[3]+"</span></div>",i+='<div class="layout-row popup-layout-padding"><span class="prefix">cNum:</span><span class="value">'+t.data[4]+"</span></div>",c.structurePopup.setLatLng(t.latlng).setContent(i).openOn(c.map)})),this.structureImage.on("mouseout",(function(e){c.map.closePopup()})),this.structureImage.on("click",(function(e){c.routeClicked()})),this.structureContainerEach.addChild(this.structureImage,this.structureImageText),a.addChild(this.structureContainerEach)},e.prototype.openSpiderCircularPopups=function(e,t){var a=t.componentFactoryResolver.resolveComponentFactory(c.a);t.componentRef=t.target.createComponent(a),t.componentRef.instance.colocatedCircleData=[{tileName:e.data.device,fontValue:e.data.fontvalue,fontFamily:e.data.font,color:e.data.color,radiusDeviceCircle:"56"}],t.componentRef.instance.data=this.structureData,t.componentRef.instance.mainRef=this,t.componentRef.instance.mainLayerReference=this.mainLayerRef},e.prototype.openSpiderPopups=function(e,t){if("Structure"==e.data.name){var a=new s.a("Route");this.dialog.open(s.b,{width:"1200px",height:"500px",position:{left:"18.5rem",top:"4rem"},data:a,hasBackdrop:!1,disableClose:!1,panelClass:"material-dialog-container"})}else if("Logical Connectivity"==e.data.name){this.dataShare.setExtraLayer({parentToChild:"Logical-Connectivity",child:"Topologies-Structure-Planned"}),this.dataShare.countLogicalMessage(),this.removeLayer();var i=t.componentFactoryResolver.resolveComponentFactory(l.a);t.componentRef=t.target.createComponent(i)}},e.prototype.routeClicked=function(){var e=new s.a("Structure");this.dialog.open(s.b,{width:"1200px",height:"500px",position:{left:"18.5rem",top:"4rem"},data:e,hasBackdrop:!1,disableClose:!1,panelClass:"material-dialog-container"})},e.prototype.removeLayer=function(){null!=this.routeFibreCoreLayer&&this.map.removeLayer(this.routeFibreCoreLayer)},e.prototype.drawCircularCircle=function(e,t,a,n,s,c,l,u){this.stageRouteContainer.removeAllChildren(),this.stageRouteContainer.update(),this.circleGraphic=this.drawCircleGraphics("#003B7440",65),this.circleCountShape=new r.Shape(this.circleGraphic),this.circleCountShape.alpha=.4,this.innercircleGraphic=this.drawCircleGraphics("#003A74",21),this.innercircleShape=new r.Shape(this.innercircleGraphic),this.textContainer=new r.Container,this.textContainer.x=a.x,this.textContainer.y=a.y,this.textContainer.latLng=new o.LatLng(l,u),this.labelCount=new r.Bitmap("assets/images/Layers/topologies/structure/All.svg"),this.labelCount.regX=35,this.labelCount.regY=30,this.labelCount.scaleX=.4,this.labelCount.scaleY=.4,this.labelCount.latlng=this.textContainer.latLng;var h=this;this.textContainer.addEventListener("click",(function(t){h.clonedArray=Object(i.h)(h.structureColocatedData),h.clonedArray.splice(e,h.clonedArray.length-e),h.map.setView(s),h.colocatedStructureClicked(t,n,c,h.clonedArray)})),this.textContainer.addChild(this.circleCountShape,this.innercircleShape,this.labelCount),t.addChild(this.textContainer),this.stageRouteContainer.update()},e.prototype.drawCircleGraphics=function(e,t){return this.drawCircleGraphic=new r.Graphics,this.drawCircleGraphic.beginFill(e),this.drawCircleGraphic.drawCircle(0,0,t),this.drawCircleGraphic},e.prototype.colocatedStructureClicked=function(e,t,a,o){return Object(i.b)(this,void 0,void 0,(function(){var e;return Object(i.e)(this,(function(i){return console.log(t),e=t.componentFactoryResolver.resolveComponentFactory(u.a),t.componentRef=t.target.createComponent(e),t.componentRef.instance.data=o,t.componentRef.instance.colocatedCircularCircleData=a,t.componentRef.instance.mainRef=this,t.componentRef.instance.mainLayerReference=t,[2]}))}))},e.prototype.ngOnDestroy=function(){this.routeReadyFibreCoreSubscription&&this.routeReadyFibreCoreSubscription.unsubscribe()},e.\u0275fac=function(t){return new(t||e)(p.Ub(d.a),p.Ub(g.b),p.Ub(m.a),p.Ub(v.b),p.Ub(C.b))},e.\u0275cmp=p.Ob({type:e,selectors:[["app-nominal-generation-layer"]],decls:2,vars:0,template:function(e,t){1&e&&(p.ac(0,"p"),p.Vc(1,"nominal-generation-layer works!"),p.Zb())},styles:[""]}),e}()}}]);